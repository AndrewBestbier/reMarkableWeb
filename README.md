Very very WIP! Excuse the messy code, not my best work.